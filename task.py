#! /usr/bin/env python
# -*-coding:utf-8 -*-
import time
from celery import Celery
import workarch
import sys
import paramiko

#app = Celery('workarch', broker='amqp://admin:admin@192.168.200.140//', backend='amqp://')
app.config_from_object('config')
#app = Celery('workarch', broker='redis://192.168.200.138:6379/',backend='redis://192.168.200.138:6379/0')


url  = sys.argv[1]
dict = sys.argv[2]

flag = True
print 'here'
print app.control.ping(timeout=0.5)  # 发送ping包，看是否能访问目标地址
#result =  workarch.add.delay(3,5)
result = workarch.scandir.delay(url,dict) # 发送具体的任务和值
#print result
print 'gogogo'
print "ID: %s" % result.id
if result.failed():
   flag = False
print "Flag: %s" % flag
print result.get()
time.sleep(1)
